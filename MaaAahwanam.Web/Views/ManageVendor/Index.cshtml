@model MaaAahwanam.Models.ManageVendor
@{
    ViewBag.Title = ":: Vendors ::";
    Layout = "~/Views/SharedWeb/vmp.cshtml";
}

@section css{
    <link rel="stylesheet" type="text/css" href="https://tympanus.net/Development/TextInputEffects/css/set1.css" />
   @*<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">*@
    <style>
        input[type=text], input[type="email"], input[type="tel"] {
            width: 101%;
            padding: 13px 0px 2px 10px;
            margin: 15px 5px 15px 0px;
            box-sizing: border-box;
            background-color: #fff;
            color: black;
        }
         .input__field {
        position: relative;
        display: block;
        float: right;
        padding: 0.8em;
        width: 60%;
        border: none;
        border-radius: 0;
        background: #f0f0f0;
        color: #aaa;
        font-weight: normal;
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        -webkit-appearance: none;
    }

    .input__label--hoshi {
        position: absolute;
        bottom: 0;
        left: 0;
        padding: 5.7em 0.25em;
        width: 100%;
        height: calc(100% - 1em);
        text-align: left;
        pointer-events: none;
    }
        table.dataTable thead th, table.dataTable tfoot th {
            white-space: nowrap;
          
        }

        table.dataTable, table.dataTable th, table.dataTable td {
            white-space: nowrap;
            border:none;
        }
        table, th, td {
            border: none;
        }
         .txtd {
        margin-top: -5%;
    }
         .dtx{
             margin-top:-2%;
         }

    </style>
}

<div class="col-md-10">
    <div class="container-fluid" style="padding:10px;">
        <div class="suppliertxt">
            <table style="width:100%">
                <tr>
                    <td><h4 style="text-transform:uppercase">Suppliers</h4></td>
                    <td style="float:right"><button id="btnadd" class="btn btn-primary">Add New Suppliers</button></td>
                </tr>
            </table>
        </div>
        <div style="overflow-x: auto;padding:10px;" >
            <table id="allorders" class="display" style="width:100%;">
                <thead>
                    <tr>
                        <th>Select</th>
                        <th>S.No</th>
                        <th>Vendor ID</th>
                        <th>Business Name</th>
                        <th>Services</th>
                        <th>First Name </th>
                        <th>Last Name</th>
                        <th>Email</th>
                        <th>Phone Number</th>
                        <th>Flat No/Street</th>
                        <th>Locality</th>
                        <th>PinCode</th>
                        <th>City</th>
                        <th>State</th>
                        <th>Country</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @{
                        var number = 0;
                        foreach (var vendors in ViewBag.vendorlist)
                        {
                            <tr>
                                <td><input type="checkbox" class="chcktbl" value="@vendors.id" /></td>
                                <td>@(++number)</td>
                                <td>@vendors.id </td>
                                <td>@vendors.Businessname</td>
                                @if (@vendors.services == null)
                                {
                                    <td></td> }
                                else
                                {
                                    <td>@String.Format(@vendors.services).Replace("&", ", ") </td>}
                                <td>@vendors.firstname </td>
                                <td>@vendors.lastname</td>
                                <td>@vendors.email</td>
                                <td>@vendors.phoneno</td>
                                <td>@vendors.adress1</td>
                                <td>@vendors.adress2</td>
                                <td>@vendors.pin_code</td>
                                <td>@vendors.city</td>
                                <td>@vendors.state</td>
                                <td>@vendors.country</td>
                                <td>@vendors.Status</td>
                                <td class="tdbtn" id="btndata"><button type="button" id="btnBook" class="btn book btn-danger" disabled>Book Now</button></td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>
        <div class="row" id="saverecord" style="display:none;margin-top:50px">
            <div align="center"><h3 style="text-transform:uppercase">Add/Edit Supplier</h3></div>
            <input type="hidden" id="vendorId" name="vendorId" value="@ViewBag.masterid" />
            <div class="col-12 col-sm-12 col-md-12">
                <div class="row">
                    <input type="hidden" id="id" name="id" value="" />
                    <div class="col-12 col-sm-4 col-md-4">
                        <span class="input input--hoshi">
                            <input class="input__field input__field--hoshi" type="text" pattern="^[a-zA-Z]+$+" title="Please enter on alphabets only" id="Businessname" name="Businessname" value="" required />
                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="Businessname">
                                <span class="input__label-content input__label-content--hoshi">Business Name</span>
                            </label>
                        </span>
                    </div>
                    <div class="col-12 col-sm-4 col-md-4">
                        @*<span class="input input--hoshi">
                                <input class="input__field input__field--hoshi" type="text"pattern="^[a-zA-Z]+$+" title="Please enter on alphabets only" id="services" name="services" value="" required />
                                <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="services">
                                    <span class="input__label-content input__label-content--hoshi">Services</span>
                                </label>
                            </span>*@
                        <span class="input input--hoshi">
                            <input class="input__field input__field--hoshi" type="text" id="firstname" name="firstname" value="" />
                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="firstname">
                                <span class="input__label-content input__label-content--hoshi">First Name</span>
                            </label>
                        </span>
                    </div>
                    <div class="col-12 col-sm-4 col-md-4">
                        <span class="input input--hoshi">
                            <input class="input__field input__field--hoshi" type="text" pattern="[a-zA-Z]+" title="Please enter on alphabets only" id="lastname" name="lastname" value="" required />
                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="lastname">
                                <span class="input__label-content input__label-content--hoshi">Last Name</span>
                            </label>
                        </span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-sm-4 col-md-4">
                        <span class="input input--hoshi txtd">
                            <input class="input__field input__field--hoshi" type="email" id="email" name="email" value="" onchange="checkEmail(this.value)" pattern="^[a-zA-Z0-9._+-]+@("@")[a-zA-Z0-9.-]+\.[a-zA-Z]{2,9}$+" title="Please enter valid email" required />
                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="email">
                                <span class="input__label-content input__label-content--hoshi">Email</span>
                            </label>
                        </span>
                    </div>
                    <div class="col-12 col-sm-4 col-md-4">
                        <span class="input input--hoshi txtd">
                            <input class="input__field input__field--hoshi" type="text" id="phoneno" name="phoneno" minlength="10+" title="Enter Numbers and 10 digits only" value="" maxlength="10" pattern="[0-9]{10}" required />
                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="phoneno">
                                <span class="input__label-content input__label-content--hoshi">Phone Number</span>
                            </label>
                        </span>
                    </div>
                    <div class="col-12 col-sm-4 col-md-4">
                        <span class="input input--hoshi txtd">
                            <input class="input__field input__field--hoshi" type="text" id="adress1" name="adress1" value="" required />
                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="adress1">
                                <span class="input__label-content input__label-content--hoshi"> Flat No/Street</span>
                            </label>
                        </span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-sm-4 col-md-4">
                        <span class="input input--hoshi txtd">
                            <input class="input__field input__field--hoshi" type="text" id="adress2" name="adress2" value="" required />
                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="adress2">
                                <span class="input__label-content input__label-content--hoshi">Locality</span>
                            </label>
                        </span>
                    </div>
                    <div class="col-12 col-sm-4 col-md-4">
                        <span class="input input--hoshi txtd">
                            <input class="input__field input__field--hoshi" type="text" id="pin_code" minlength="6+" title="Enter Numbers and 6 digits only" maxlength="6" name="pin_code" value="" pattern="[0-9]+" Title="Enter number only and enter 6 digits only" required />
                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="pin_code">
                                <span class="input__label-content input__label-content--hoshi">PinCode</span>
                            </label>
                        </span>
                    </div>
                    <div class="col-12 col-sm-4 col-md-4">
                        <span class="input input--hoshi txtd">
                            <input class="input__field input__field--hoshi" type="text" id="city" name="city" pattern="[a-zA-Z]+" title="Please enter on alphabets only" value="" required />
                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="city">
                                <span class="input__label-content input__label-content--hoshi">City</span>
                            </label>
                        </span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-sm-4 col-md-4">
                        <span class="input input--hoshi txtd">
                            <input class="input__field input__field--hoshi" type="text" id="state" name="state" pattern="[a-zA-Z]+" title="Please enter on alphabets only" value="" required />
                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="state">
                                <span class="input__label-content input__label-content--hoshi">State</span>
                            </label>
                        </span>
                    </div>
                    <div class="col-12 col-sm-4 col-md-4">
                        <span class="input input--hoshi txtd">
                            <input class="input__field input__field--hoshi" type="text" id="country" name="country" pattern="[a-zA-Z]+" title="Please enter on alphabets only" value="" required />
                            <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="country">
                                <span class="input__label-content input__label-content--hoshi">Country</span>
                            </label>
                        </span>
                    </div>
                    <div class="col-12 col-sm-4 col-md-4" style="margin-top:7px;">
                        <label class="d-block mb-0" style="font-weight:bold">Status</label>
                        <fieldset class="form-check" style="display:inline">
                            <input type="radio" class="chckactive" id="Status1" name="Status" value="Active" checked required />
                            <label class="form-check-label" for="Status1">Active</label>
                        </fieldset>
                        <fieldset class="form-check" style="display:inline">
                            <input type="radio" class="chckinactive" id="Status2" name="Status" value="InActive" required />
                            <label class="form-check-label" for="Status2">InActive</label>
                        </fieldset>
                    </div>
                </div>
                <div class="row" id="selectservices">
                    <div class="container">
                        <h4 style="text-transform:uppercase">Add Services</h4>
                        <div class="card">
                            <div class="card-body">
                                <div class="row">
                                    @{
                                        foreach (var itemServices in ViewBag.SupplierServicesLst)
                                        {

                                            <div class="col-12 col-sm-2 col-md-2">
                                                @*<input type="checkbox" id="services1" name="services" value="@itemServices.ServiceName" /> <label>@itemServices.ServiceName</label>  <a href="#" id="updatesupservices" class="updateservices" onclick="updatesupplierservices('@itemServices.ID')" value="@itemServices.ID"><span class="glyphicon glyphicon-pencil"></span></a>*@
                                                <input type="checkbox" id="services1" name="services" value="@itemServices.ServiceName" /> <label>@itemServices.ServiceName</label> <span class="glyphicon glyphicon-pencil editservice" value="@itemServices.ID" style="color:cornflowerblue"></span>
                                            </div>

                                        }
                                    }
                                </div>

                                <div class="row" id="extraservices">

                                </div>
                                <div class="row moresupservices">
                                    <div class="col-12 col-md-2 col-sm-2">
                                        <a herf="/ManageVendor#" class="a" id="supplierservice" style="padding-left: 31px;color:darkred" onclick="addsupservice()"><span class="glyphicon glyphicon-plus-sign" style="font-size: 30px;"></span></a>
                                    </div>
                                </div>
                            </div>
                        </div>           
                    </div>
                </div>
               <div class="ui servicespopup row coupled modal"  id="servicemodel" style="margin-top:30px;max-width:50%;position:relative;">
                    <div class="adservice">
                        <div align="center" class="header" style="text-transform:uppercase;font-weight:bold;margin-top:30px;">Add/Edit Services</div>
                        <div class="col-12 col-sm-12 col-md-12" align="center">
                            <input type="hidden" id="VendorMasterID" name="VendorMasterID" value="@ViewBag.masterid" />
                            <input type="hidden" id="ID" name="ID" value="" />
                            <div class="row">
                                <div class="col-12 col-sm-12 col-md-12">
                                    <span class="input input--hoshi">
                                        <input class="input__field input__field--hoshi" type="text" id="ServiceName" name="ServiceName" value="" onchange="checksupplierservices(this.value)"/>
                                        <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="ServiceName">
                                            <span class="input__label-content input__label-content--hoshi">Service Name</span>
                                        </label>
                                    </span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-12 col-sm-12 col-md-12">
                                    <span class="input input--hoshi dtx">
                                        <input class="input__field input__field--hoshi" type="text" id="description" name="description" />
                                        <label class="input__label input__label--hoshi input__label--hoshi-color-1" for="description">
                                            <span class="input__label-content input__label-content--hoshi">Description</span>
                                        </label>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="actions">
                            <div class="row">
                                <div class="col-md-4" style="padding-left:190px;">
                                    <button id="ADDsupServices" type="button" name="command" value="Save" class="btn btn-success" style="display:block">Save</button>
                                    <button id="Updatesupservices" type="button" name="command" value="Update" class="btn btn-success" style="display:none">Update</button>
                                </div>
                                <div class="col-md-4" style="padding-left:50px;">
                                    <button id="CancelsupServices" type="button" class="btn btn-danger">Cancel</button>
                                </div>
                            </div>
                        </div>
                    </div>
                
                </div>
                <div class="b txtd" align="center" style="margin-top:30px;">
                    <div style="position: absolute; left: 471px;">
                        <button id="SaveVendor" type="submit" name="command" value="Save" class="btn btn-success" style="display:block">Save</button>
                        <button id="EditVendor" type="submit" name="command" value="Update" class="btn btn-success" style="display:none">Update</button>
                    </div>
                    <div style="position:absolute; display: inline;">
                        <button id="CancelVendor" type="button" class="btn btn-danger">Cancel</button>
                    </div>
                </div>
            </div>        
        </div>
    </div>
</div>


@section scripts{
    <script src="~/Scripts/mngvendor.js"></script>
    <script>
        $('#ADDsupServices').click(function () {
            var val = $(this).val();
            var Id = $('#id').val();
            var supplierservices = {
                VendorMasterID:$('#VendorMasterID').val(),
                ServiceName: $('#ServiceName').val(),
                Description: $('#description').val()
            }
            $.ajax({
                url: '/ManageVendor/SupplierServices?command=' + val + '&&id=' + Id,
                type: 'POST',
                data: JSON.stringify({ supplierservices: supplierservices }),
                contentType: 'application/json',
                success: function (data) {
                    alert(data);                
                    var sname = $('#ServiceName').val();
                    $('#extraservices').append(' <div class="col-12 col-sm-2 col-md-2"><input type="checkbox" id="PhotoGraphy" name="services" value="' + sname + '" /> <label>' + sname + '</label>  <a href="#" id="updatesupservices" onclick="updatesupplierservices()"><span class="glyphicon glyphicon-pencil"></span></a></div>');
                    $('#ServiceName').val('');
                    $('#description').val('');
                    $('#servicemodel').modal('hide');
                   
                },
                error: function (data) {
                    alert("save is failed");
                }
            })
           
        });

        var pdiv = '';
        $('.editservice').click(function () {
            var serviceid = $(this).attr('value');
            pdiv = '';
            pdiv = $(this).parent('div');
            //alert(serviceid);
            $.ajax({
                url: '/ManageVendor/Getsupplierservice?id=' + serviceid,
                type: 'POST',
                contentType: 'application/json',
                success: function (result) {
                    $('#servicemodel #ServiceName').val(result.ServiceName);
                    $('#servicemodel #description').val(result.Description);
                    $('#servicemodel #ID').val(serviceid);
                    $('#Updatesupservices').css('display', 'block');
                    $('#ADDsupServices').css('display', 'none');
                    $('#servicemodel').modal('show');
                }
            });
        });

        $('#Updatesupservices').click(function () {
            var parentdiv = pdiv;
            var serviceid = $('#servicemodel #ID').val();
            var supplierservices = {
                VendorMasterID: $('#servicemodel #VendorMasterID').val(),
                ServiceName: $('#servicemodel #ServiceName').val(),
                Description: $('#servicemodel #description').val()
            }
            $.ajax({
                url: '/ManageVendor/SupplierServices?command=Update&&id=' + serviceid,
                type: 'POST',
                data: JSON.stringify({ supplierservices: supplierservices }),
                contentType: 'application/json',
                success: function (data) {
                    alert(data);
                    parentdiv.find('label').text($('#servicemodel #ServiceName').val());
                    $('#servicemodel').modal('hide');
                },
                error: function (data) {
                    alert("update is failed");
                }
            })
        });
        function checksupplierservices(val) {
            var VendorMasterID = $('#VendorMasterID').val();
            $.ajax({
                url: '/ManageVendor/checksupplierservices?servicename=' + val + "&&vid=" + VendorMasterID,
                type: 'Post',
                contentType: 'application/json',
                success: function (result) {
                    if (result == "sucess1") {
                        alert("Services is already existed select another Services");
                        $('#ServiceName').val('').focus();
                    }
                },
                error: function (result) {
                    alert("failed");
                }
            });
        }
    </script>
}